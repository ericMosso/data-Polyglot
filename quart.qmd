---
title: "Polyglot Data Analysis"
author: "Eric Mossotti"
format: html
code-fold: true
code-tools: true
editor: visual
---

## Quarto


```{r}

library(RPostgreSQL)
library(DBI)
library(dplyr)

# Reading in a Kaggle csv made for Heart Disease Prediction.

# Creates a dataframe to be used later when we create a SQL database table from it.

heartDF <- read.csv2 ( "Heart_Disease_Prediction.csv", 
                       header = TRUE, 
                       sep = "," )

# Establishing a connection with a local PostgreSQL database.

con <- dbConnect ( odbc::odbc(), 
                   "PostgreSQL35W", 
                   timeout = 10 )


# Using dbWriteTable() to create a table from the dataframe


dbWriteTable ( con, 
               "HeartTable", 
               heartDF, 
               row.names = FALSE, 
               append = TRUE )



# Using dplyr to select a table from the PostgreSQL database

heartTable_dplyr <- tbl ( con, "HeartTable" )

# Querying the table with dplyr and piping function operator

# Grouping by the presence or absence of heart disease, 
# and calculating the average BP of those groups.

heartTable_dplyr %>% 
  group_by ( Heart.Disease ) %>%
  summarize ( BP_AVERAGE = mean ( BP ) ) %>%
  
  # Creates a dataframe from the results of the query above.
  
  collect()









```

```{python}





```

